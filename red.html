<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Тренажёр «Часики»</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #f4f7fc;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    h1 {
      font-size: 2rem;
      color: #2c3e50;
      margin-top: 20px;
    }
    .level-buttons {
      margin: 20px auto;
      display: flex;
      justify-content: center;
      gap: 10px;
    }
    .level-buttons button {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      background-color: #3498db;
      color: white;
      font-size: 1rem;
      cursor: pointer;
    }
    .level-buttons button.active {
      background-color: #2c3e50;
    }
    .progress-block {
      margin: 10px auto;
    }
    .progress-bar {
      height: 10px;
      background: #e0e0e0;
      border-radius: 8px;
      overflow: hidden;
      margin: 8px auto;
      width: 80%;
    }
    .progress-bar-inner {
      height: 100%;
      background: #3498db;
      width: 0%;
      transition: width 0.3s;
    }
    .clock {
      position: relative;
      width: 300px;
      height: 300px;
      border: 5px solid #3498db;
      border-radius: 50%;
      margin: 20px auto;
      background: #fff;
    }
    .number {
      position: absolute;
      width: 24px;
      height: 24px;
      text-align: center;
      font-weight: bold;
      color: #2c3e50;
      font-size: 1rem;
    }
    .hand {
      position: absolute;
      bottom: 50%;
      left: 50%;
      transform-origin: bottom center;
      border-radius: 8px;
    }
    .hand.hour {
      width: 6px;
      height: 80px;
      background: red;
    }
    .hand.minute {
      width: 4px;
      height: 110px;
      background: blue;
    }
    .panel {
      background: white;
      padding: 20px;
      max-width: 350px;
      margin: auto;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
    }
    input {
      padding: 10px;
      font-size: 1rem;
      margin: 10px 0;
      width: 100%;
      box-sizing: border-box;
    }
    button {
      margin: 10px 5px;
    }
    .btn-main {
      background-color: #3498db;
      color: white;
    }
    .btn-secondary {
      background-color: #bdc3c7;
      color: white;
    }
  </style>
</head>
<body>

<h1>Тренажёр «Часики»</h1>

<div class="level-buttons">
  <button class="active" onclick="setLevel(1)">Уровень 1</button>
  <button onclick="setLevel(2)">Уровень 2</button>
  <button onclick="setLevel(3)">Уровень 3</button>
</div>

<div class="progress-block">
  <p>Правильно: <span id="correct">0</span> — Неправильно: <span id="incorrect">0</span></p>
  <p>Прогресс: <span id="progressPercent">0%</span></p>
  <div class="progress-bar"><div class="progress-bar-inner" id="progressBar"></div></div>
</div>

<div class="clock" id="clock">
  <div class="hand hour" id="hourHand"></div>
  <div class="hand minute" id="minuteHand"></div>
</div>

<div class="panel">
  <h3 id="instruction">Установите время: <strong id="targetTime">--:--</strong></h3>
  <input id="timeInput" placeholder="ЧЧ:ММ">
  <br>
  <button class="btn-main" onclick="checkAnswer()">Проверить</button>
  <button class="btn-secondary" onclick="generateTime()">+ Новое задание</button>
</div>

<script>
  const hourHand = document.getElementById('hourHand');
  const minuteHand = document.getElementById('minuteHand');
  const timeDisplay = document.getElementById('targetTime');
  const timeInput = document.getElementById('timeInput');
  const progressBar = document.getElementById('progressBar');
  const progressPercent = document.getElementById('progressPercent');
  const correctEl = document.getElementById('correct');
  const incorrectEl = document.getElementById('incorrect');

  let correct = 0, incorrect = 0;
  let currentLevel = 1;
  let currentHour = 0;
  let currentMinute = 0;

  function setLevel(level) {
    currentLevel = level;
    document.querySelectorAll('.level-buttons button').forEach(btn => btn.classList.remove('active'));
    document.querySelectorAll('.level-buttons button')[level - 1].classList.add('active');
    generateTime();
  }

  function generateTime() {
    currentHour = Math.floor(Math.random() * 24);
    currentMinute = currentLevel === 1 ? [0, 15, 30, 45][Math.floor(Math.random() * 4)] :
                    currentLevel === 3 ? Math.floor(Math.random() * 12) * 5 :
                    Math.floor(Math.random() * 60);
    updateClock(currentHour, currentMinute);
    timeDisplay.textContent = currentLevel === 2 ? '??' : formatTime(currentHour, currentMinute);
    timeInput.value = '';
  }

  function updateClock(hour, minute) {
    let hourDeg = ((hour % 12) + minute / 60) * 30;
    let minuteDeg = minute * 6;
    hourHand.style.transform = `rotate(${hourDeg}deg)`;
    minuteHand.style.transform = `rotate(${minuteDeg}deg)`;
    placeNumbers();
  }

  function placeNumbers() {
    const clock = document.getElementById('clock');
    clock.querySelectorAll('.number').forEach(n => n.remove());
    const size = 300;
    const cx = size / 2;
    const cy = size / 2;
    const r = cx - 25;
    for (let i = 1; i <= 12; i++) {
      const ang = (i - 3) * (Math.PI / 6);
      const div = document.createElement('div');
      div.className = 'number';
      div.style.left = `${cx + r * Math.cos(ang) - 12}px`;
      div.style.top = `${cy + r * Math.sin(ang) - 12}px`;
      div.textContent = i;
      clock.appendChild(div);
    }
  }

  function checkAnswer() {
    let val = timeInput.value.trim();
    if (!/^\d{1,2}:\d{2}$/.test(val)) return alert("Формат: ЧЧ:ММ");
    let [h, m] = val.split(":").map(x => parseInt(x));
    if (h === currentHour && m === currentMinute) {
      correct++;
    } else {
      incorrect++;
      alert(`Неправильно. Правильное время: ${formatTime(currentHour, currentMinute)}`);
    }
    updateProgress();
    generateTime();
  }

  function updateProgress() {
    const total = correct + incorrect;
    const percent = total ? Math.round((correct / total) * 100) : 0;
    correctEl.textContent = correct;
    incorrectEl.textContent = incorrect;
    progressPercent.textContent = percent + "%";
    progressBar.style.width = percent + "%";
  }

  function formatTime(h, m) {
    return (h < 10 ? '0' + h : h) + ":" + (m < 10 ? '0' + m : m);
  }

  window.onload = () => {
    setLevel(1);
  };
</script>

</body>
</html>